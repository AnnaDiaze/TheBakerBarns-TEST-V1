<!DOCTYPE html>
<html>
<head>
    <%- include('partials/header1.ejs') %>
  <title>Order <%= order.id %> Details</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { margin-bottom: 10px; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ccc;
      text-align: center;
    }
    th { background: #f4f4f4; }
    .back-link {
      margin-top: 20px;
      display: inline-block;
      padding: 8px 14px;
      background: #4CAF50;
      color: white;
      text-decoration: none;
      border-radius: 4px;
    }
    .back-link:hover { background: #45a049; }
  </style>
</head>
<body>
    <header>
    <h1>The Baker Barns Bakery</h1>
    <%- include('partials/navbar1.ejs') %>
  </header>
  <h1>Order #<%= order.id %></h1>
  <p><strong>Customer:</strong> <%= order.customer_name %></p>
  <p><strong>Email:</strong> <%= order.email %></p>
  <p><strong>Phone:</strong> <%= order.phone %></p>
  <p><strong>Pickup Date:</strong> <%= order.pickup_date.toISOString().split('T')[0] %></p>
  <p><strong>Status:</strong> <%= order.status %></p>
  <p><strong>Total:</strong>$<%= (parseFloat(order.total_amount) || 0).toFixed(2) %></p> <!--fixed numder error-->

  <h2>Items</h2>
  <table>
    <thead>
      <tr>
        <th>Product</th>
        <th>Quantity</th>
        <th>Price Each</th>
        <th>Subtotal</th>
      </tr>
    </thead>
    <tbody>
      <% items.forEach(item => { %>
        <tr>
          <td>
            <%= item.product_name %>
            <% if (item.custom_cake_order_id) { %>
              <br><small><em>(Custom Cake)</em></small>
              <% if (item.custom_options) { %>
                <br><small><%= item.custom_options %></small>
              <% } %>
            <% } %>
          </td>
          <td><%= item.quantity %></td>
          <td>$<%= (parseFloat(item.price_each) || 0).toFixed(2) %></td>
          <td>$<%= ((item.quantity || 0) * (parseFloat(item.price_each) || 0)).toFixed(2) %></td>
        </tr>
      <% }) %>
    </tbody>
  </table>

  <a href="/admin/orders" class="back-link">‚Üê Back to Orders</a>
</body>
</html>