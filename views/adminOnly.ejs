<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('partials/header1.ejs') %>
  <title>Admin Panel</title>
  <style>
  /* Global admin layout tweaks */
  .admin-actionbar {
    padding:12px 16px; margin-top:24px;
    display:flex; gap:8px; flex-wrap:wrap;
  }

  .dash { max-width:1400px; margin: 16px auto 32px; padding: 0 10px; }

  .welcome {
    background:#ffe4e1; border:1px solid #f6c2cb; color:#8a3d3d;
    border-radius:12px; padding:18px; text-align:center;
    box-shadow:0 4px 10px rgba(0,0,0,.05); margin-bottom:16px;
  }

  /* ----- STAT GRID SECTION ----- */
  .stat-grid {
    display:flex;
    justify-content:space-between;
    gap:16px;
    flex-wrap:nowrap;     /* prevents breaking to next line */
    overflow-x:auto;      /* scrolls horizontally if too many stats */
    margin-bottom:16px;
  }

  .stat {
    flex:1;
    background:#fff;
    border:1px solid #eee;
    border-radius:12px;
    padding:16px;
    text-align:center;
    box-shadow:0 4px 10px rgba(0,0,0,.05);
    min-width:220px; /* ensures consistent width */
  }

  .stat h4 { margin:0 0 6px; font-size:14px; color:#777; }
  .stat .num { font-size:28px; font-weight:800; color:#b35414; line-height:1; }
  .stat small { display:block; margin-top:6px; color:#888; }

  /* ----- TILE GRID SECTION ----- */
  .tiles {
    display:flex;
    justify-content:space-between;
    gap:16px;
    flex-wrap:nowrap;      /* keeps in one line */
    overflow-x:auto;       /* allow scroll if narrow screen */
    padding-bottom:8px;
  }

  .tile {
    flex:1;
    min-width:240px;
    background:#fff;
    border:1px solid #eee;
    border-radius:12px;
    padding:14px;
    box-shadow:0 4px 10px rgba(0,0,0,.05);
  }

  .tile h5 { margin:0 0 8px; font-size:16px; color:#333; display:flex; align-items:center; gap:8px; }
  .tile p { margin:0 0 12px; color:#666; font-size:14px; min-height:44px; }

  .kpi {
    margin-top:22px;
    background:#fff;
    border:1px solid #eee;
    border-radius:12px;
    padding:14px;
    box-shadow:0 4px 10px rgba(0,0,0,.05);
  }

  .kpi h3 { margin:0 0 8px; font-size:16px; }

  @media (max-width:900px) {
    .stat-grid, .tiles { flex-wrap:wrap; }
  }
  </style>

</head>
<body>
  <header>
    <h1>The Baker Barns Bakery</h1>
    <%- include('partials/navbar1.ejs') %>
  </header>

  <!-- Admin nav -->
  <nav class="cart-container cart-container--wide admin-actionbar">
    <a class="btn btn-accent"  href="/adminOnly">Admin Panel</a>
    <a class="btn btn-primary" href="/admin/Orders">Manage Orders</a>
    <a class="btn btn-primary" href="/admin/Products">Manage Products</a>
    <a class="btn btn-primary" href="/admin/Recipes">Manage Recipes</a>
    <a class="btn btn-primary" href="/admin/Messages">Manage Messages</a>
    <a class="btn btn-primary" href="/admin/Users">Manage Users</a>
  </nav>

  <main class="dash">
    <!-- Welcome / CTA -->
    <section class="welcome">
      <h2 style="margin:0;">Welcome, <%= username %>!</h2>
      <p style="margin:.35rem 0 1rem;">Here‚Äôs a quick snapshot of your bakery and this month‚Äôs sales.</p>
      <a href="/admin/Orders" class="btn btn-primary btn-sm">View Orders</a>
    </section>

    <!-- Top stats -->
    <section class="stat-grid">
      <div class="stat">
        <h4>Orders</h4>
        <div class="num"><%= ordersTotal %></div>
        <small>Pending: <%= ordersPending %> ¬∑ Completed: <%= ordersCompleted %></small>
      </div>

      <div class="stat">
        <h4>Products</h4>
        <div class="num"><%= productsActive %></div>
        <small>Archived: <%= productsArchived %> ¬∑ Low stock: <%= productsLowStock %></small>
      </div>
      
      <div class="stat">
        <h4>Messages</h4>
        <div class="num"><%= messagesTotal %></div>
        <small>New: <%= messagesNew %></small><br>
        <!-- <a href="/admin/Messages" class="btn btn-primary btn-sm" style="margin-top:6px;">View Messages</a> -->
      </div>

      <div class="stat">
        <h4>Users</h4>
        <div class="num"><%= usersTotal %></div>
        <small>Active: <%= usersActive %> ¬∑ Blocked: <%= usersBlocked %></small>
      </div>
    </section>

    <!-- Month KPI (no chart) -->
    <section class="kpi">
      <h3>This Month‚Äôs Sales (Completed)</h3>
      <div style="font-weight:800; font-size:22px; color:#b35414;">
        <%= monthName %> total: $<%= Number(monthSalesTotal || 0).toFixed(2) %>
      </div>
    </section>
  

    <!-- Quick tiles -->
    <section class="tiles">
      <article class="tile">
        <h5>üßæ Manage Orders</h5>
        <p>Review new orders, update statuses, and view item details for pickup.</p>
        <a href="/admin/Orders" class="btn btn-primary btn-sm">Open Orders</a>
      </article>

      <article class="tile">
        <h5>üßÅ Manage Products</h5>
        <p>Add new items, edit descriptions/prices/stock, or archive/restore products.</p>
        <a href="/admin/Products" class="btn btn-primary btn-sm">Open Products</a>
      </article>

      <article class="tile">
        <h5>üìã Manage Recipes</h5>
        <p>Maintain recipe content (titles, ingredients, methods, and images).</p>
        <a href="/admin/Recipes" class="btn btn-primary btn-sm">Open Recipes</a>
      </article>

      <article class="tile">
        <h5>‚úâÔ∏è Manage Messages</h5>
        <p>Manage contact messages.Read and Reply to the messages from customers.</p>
        <a href="/admin/Messages" class="btn btn-primary btn-sm">Open Messages</a>
      </article>

      <article class="tile">
        <h5>üë§ Manage Users</h5>
        <p>Update roles, block/unblock users, or remove accounts.</p>
        <a href="/admin/Users" class="btn btn-primary btn-sm">Open Users</a>
      </article>
    </section>
  </main>
    

  <footer>
    <p>&copy; 2025 The Baker Barns Bakery</p>
  </footer>
</body>
</html>
