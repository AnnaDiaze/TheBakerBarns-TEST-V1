<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('partials/header1.ejs') %>
</head>
<body>
    <header>
        <h1>The Baker Barns Bakery</h1>
        <%- include('partials/navbar1.ejs') %>
    </header>
    
    <h2>ðŸ›’ Your Shopping Cart</h2>
    
    <div class="cart-container">
      
    </div>

    <main>
      <% if (!cartItems || cartItems.length === 0) { %>
        <p>Your cart is empty.</p>
        <% } else { %>
          <table class = "cart-table">
            <thead>
              <tr>
                <th>Product</th>
                <th>Qty</th>
                <th>Price</th>
                <th>Subtotal</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <% cartItems.forEach(item => { %>
                <tr>
                  <td><%= item.name %></td>
                  <td>
                    <form method="POST" action="/cart/update">
                      <input type="hidden" name="item_id" value="<%= item.item_id %>">
                      <input type="number" name="quantity" value="<%= item.quantity %>" min="1">
                      <button type="submit">Update</button>
                    </form>
                  </td>
                  <td>$<%= Number(item.price || 0).toFixed(2) %></td>
                  <td>$<%= (Number(item.price || 0) * Number(item.quantity || 0)).toFixed(2) %></td>
                  <td>
                    <form method="POST" action="/cart/remove">
                      <input type="hidden" name="item_id" value="<%= item.item_id %>">
                      <button type="submit">Remove</button>
                    </form>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>
          <p>
            <div class="cart-total">
              <strong>Total: $<%= cartItems.reduce((s,i)=> s + (i.price||0)*(i.quantity||0), 0).toFixed(2) %></strong>
            </div>
          </p>

          <p>
            <% if (user) { %>
              <a href="/checkout" class="btn btn-primary">Proceed to Checkout</a>
            <% } else { %>
              <a href="/login-required" class="btn btn-primary">Checkout</a>
              <% } %>
            </p>
            <% } %>
    </main>
  </div>
<footer>
    <p>&copy; 2025 The Baker Barns Bakery</p>
  </footer>
</body>
</html>

